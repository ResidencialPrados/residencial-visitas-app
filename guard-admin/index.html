<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard Guardia Administrador</title>

  <!-- Tema global (verde residencial + responsive) -->
  <link rel="stylesheet" href="../css/theme.css">

  <!-- Estilos específicos de guard-admin -->
  <link rel="stylesheet" href="css/styles-guard-admin.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js" defer></script>

  <!-- QR Scanner -->
  <script src="https://unpkg.com/html5-qrcode" defer></script>
</head>
<body>
  <header>
    <h1>Dashboard Guardia Administrador</h1>
    <nav class="button-group">
      <button id="logoutBtn">Cerrar sesión</button>
      <button id="activarQRBtn">Activar Lector QR</button>
      <button id="toggleHistorialBtn">Ver Historial Completo</button>
    </nav>
  </header>

  <main>
    <section id="qr-reader" aria-hidden="true"></section>

    <section>
      <h2 id="visitas-title">Visitas Pendientes (últimas 24 h)</h2>
      <table id="visitas-pendientes">
        <thead>
          <tr>
            <th>Nombre Visitante</th>
            <th>Marca</th>
            <th>Color</th>
            <th>Placa</th>
            <th>Casa</th>
            <th>Bloque</th>
            <th>Teléfono</th>
            <th>Guardia</th>
            <th>Hora</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody id="visitas-body">
          <tr><td colspan="10" class="loading">Cargando…</td></tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Registro de Usuario</h2>
      <form id="crearUsuarioForm" class="card">
        <div class="field">
          <label for="rolUsuario">Rol:</label>
          <select id="rolUsuario" required>
            <option value="">Seleccione rol</option>
            <option value="guard">Guardia Común</option>
            <option value="guard_admin">Guardia Administrador</option>
            <option value="resident">Residente</option>
          </select>
        </div>

        <div id="camposExtra" class="extra-fields">
          <div class="field">
            <label for="nuevoEmail">Email:</label>
            <input type="email" id="nuevoEmail" placeholder="correo@ejemplo.com" required>
          </div>
          <div class="field">
            <label for="nuevoPassword">Contraseña:</label>
            <input type="password" id="nuevoPassword" minlength="6" placeholder="Mín. 6 caracteres" required>
          </div>
          <div class="field">
            <label for="nuevoConfirmPassword">Confirmar contraseña:</label>
            <input type="password" id="nuevoConfirmPassword" minlength="6" placeholder="Repite la contraseña" required>
          </div>

          <div class="field" id="labelNombre">
            <label for="nuevoNombre">Nombre completo:</label>
            <input type="text" id="nuevoNombre">
          </div>
          <div class="field" id="labelIdentidad">
            <label for="nuevoIdentidad">Identidad:</label>
            <input type="text" id="nuevoIdentidad">
          </div>
          <div class="field" id="labelTelefono">
            <label for="nuevoTelefono">Teléfono:</label>
            <input type="text" id="nuevoTelefono">
          </div>
          <div class="field" id="labelCasa">
            <label for="nuevoCasa">Casa:</label>
